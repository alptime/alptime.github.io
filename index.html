<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schweizerdeutsche Uhr</title>
    <style>
        :root {
            --text-color: white;
            --bg-color: black;
            --bg-gradient: none;
        }
        
        body {
            margin: 0;
            padding: 0;
            font-family: 'Helvetica', sans-serif;
            background: var(--bg-gradient, var(--bg-color));
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        
        .header {
            padding: 20px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .header:hover,
        .header.visible {
            opacity: 1;
        }
        
        .menu-icon {
            cursor: pointer;
            width: 30px;
            height: 20px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        
        .fullscreen-btn {
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        
        .fullscreen-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .fullscreen-icon {
            display: inline-block;
        }
        
        .menu-line {
            height: 3px;
            background-color: var(--text-color);
            transition: 0.3s;
            border-radius: 2px;
        }
        
        .sidebar {
            position: fixed;
            top: 0;
            left: -350px;
            height: 100%;
            width: 350px;
            background-color: rgba(51, 51, 51, 0.95);
            backdrop-filter: blur(10px);
            transition: 0.3s ease;
            padding: 20px;
            z-index: 100;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.3);
        }
        
        .sidebar.active {
            left: 0;
        }
        
        .close-btn {
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
            text-align: right;
            margin-bottom: 20px;
            padding: 5px;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        
        .close-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .clock-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }
        
        .clock {
            position: relative;
            width: 500px;
            height: 500px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .second-hand {
            position: absolute;
            width: 12px;
            height: 12px;
            background-color: var(--text-color);
            border-radius: 50%;
            transform-origin: center;
            transition: transform 0.1s ease-out;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
        }
        
        .time-text {
            font-size: 2.8rem;
            text-align: center;
            z-index: 10;
            max-width: 80%;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-color);
            font-weight: 500;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            box-sizing: border-box;
            margin-bottom: 10px;
            background-color: #444;
            border: 1px solid #666;
            border-radius: 5px;
            color: white;
            font-size: 14px;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #888;
            box-shadow: 0 0 5px rgba(255, 255, 255, 0.2);
        }
        
        button {
            padding: 10px 15px;
            background-color: #555;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
            margin-right: 10px;
            transition: background-color 0.3s ease;
            font-size: 14px;
        }
        
        button:hover {
            background-color: #666;
        }
        
        button:active {
            background-color: #444;
        }
        
        .color-picker {
            display: flex;
            gap: 10px;
            margin-top: 5px;
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            z-index: 50;
        }
        
        .gradient-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .gradient-preview {
            height: 40px;
            border-radius: 5px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border-color 0.3s ease;
        }
        
        .gradient-preview:hover,
        .gradient-preview.selected {
            border-color: white;
        }
        
        .custom-dialect-item {
            background-color: #555;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: 1px solid #666;
        }
        
        .custom-dialect-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .delete-dialect-btn {
            background-color: #d32f2f;
            padding: 5px 10px;
            font-size: 12px;
            margin: 0;
        }
        
        .delete-dialect-btn:hover {
            background-color: #b71c1c;
        }
        
        h2, h3, h4 {
            color: var(--text-color);
            margin-top: 0;
        }
        
        h2 {
            border-bottom: 2px solid #666;
            padding-bottom: 10px;
        }
        
        .section {
            background-color: rgba(68, 68, 68, 0.3);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="header" id="header">
        <div class="menu-icon" onclick="toggleSidebar()">
            <div class="menu-line"></div>
            <div class="menu-line"></div>
            <div class="menu-line"></div>
        </div>
        <button id="fullscreenBtn" class="fullscreen-btn" onclick="toggleFullscreen()">
            <span class="fullscreen-icon">⛶</span>
        </button>
    </div>
    
    <div class="overlay" onclick="toggleSidebar()"></div>
    
    <div class="sidebar">
        <div class="close-btn" onclick="toggleSidebar()">×</div>
        <h2>Einstellungen</h2>
        
        <div class="section">
            <h3>Account</h3>
            <div id="loginForm">
                <label for="email">E-Mail:</label>
                <input type="email" id="email" placeholder="deine@email.ch">
                <label for="password">Passwort:</label>
                <input type="password" id="password" placeholder="Passwort">
                <button onclick="login()">Anmelden</button>
                <button onclick="register()">Registrieren</button>
            </div>
            <div id="loggedInInfo" style="display: none;">
                <p>Angemeldet als: <span id="userEmail"></span></p>
                <button onclick="logout()">Abmelden</button>
            </div>
        </div>
        
        <div class="section">
            <h3>Farbeinstellungen</h3>
            <label for="textColor">Textfarbe:</label>
            <input type="color" id="textColor" value="#ffffff">
            
            <label for="backgroundType">Hintergrund-Typ:</label>
            <select id="backgroundType" onchange="toggleBackgroundOptions()">
                <option value="solid">Einfarbig</option>
                <option value="gradient">Farbverlauf</option>
            </select>
            
            <div id="solidColorOptions">
                <label for="bgColor">Hintergrundfarbe:</label>
                <input type="color" id="bgColor" value="#000000">
            </div>
            
            <div id="gradientOptions" style="display: none;">
                <label>Farbverlauf auswählen:</label>
                <div class="gradient-options">
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #667eea 0%, #764ba2 100%)" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #f093fb 0%, #f5576c 100%)" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #fa709a 0%, #fee140 100%)" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #30cfd0 0%, #91a7ff 100%)" style="background: linear-gradient(135deg, #30cfd0 0%, #91a7ff 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #a8edea 0%, #fed6e3 100%)" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%)" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);"></div>
                    <div class="gradient-preview" data-gradient="linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%)" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);"></div>
                </div>
            </div>
            
            <button onclick="changeColors()">Farben übernehmen</button>
        </div>
        
        <div class="section">
            <h3>Zeitzone</h3>
            <label for="timezone">Zeitzone wählen:</label>
            <select id="timezone">
                <option value="Europe/Zurich">Schweiz (Zürich)</option>
                <option value="Europe/Berlin">Deutschland (Berlin)</option>
                <option value="Europe/Vienna">Österreich (Wien)</option>
                <option value="Europe/Paris">Frankreich (Paris)</option>
                <option value="Europe/London">UK (London)</option>
                <option value="America/New_York">USA (New York)</option>
                <option value="America/Los_Angeles">USA (Los Angeles)</option>
                <option value="Asia/Tokyo">Japan (Tokyo)</option>
                <option value="Australia/Sydney">Australien (Sydney)</option>
            </select>
            <button onclick="changeTimezone()">Zeitzone übernehmen</button>
        </div>
        
        <div class="section">
            <h3>Dialekt</h3>
            <label for="dialect">Schweizerdeutschen Dialekt wählen:</label>
            <select id="dialect">
                <option value="zuerich">Zürich</option>
                <option value="bern">Bern</option>
                <option value="basel">Basel</option>
                <option value="luzern">Luzern</option>
                <option value="stgallen">St. Gallen</option>
                <option value="wallis">Wallis</option>
                <option value="aargau">Aargau</option>
                <option value="thurgau">Thurgau</option>
                <option value="graubuenden">Graubünden</option>
                <option value="appenzell">Appenzell</option>
            </select>
            
            <h4>Eigene Dialekte</h4>
            <div id="customDialectsList"></div>
            <button onclick="createNewDialect()">Neuen Dialekt erstellen</button>
            
            <button onclick="changeDialect()">Dialekt übernehmen</button>
        </div>
        
        <button onclick="saveSettings()">Alle Einstellungen speichern</button>
    </div>
    
    <div class="clock-container">
        <div class="clock">
            <div class="time-text" id="timeText">Laded...</div>
            <div class="second-hand" id="secondHand"></div>
        </div>
    </div>
    
    <script>
        // Globale Variablen
        let currentUser = null;
        let selectedDialect = "zuerich";
        let selectedTimezone = "Europe/Zurich";
        let selectedGradient = null;
        let users = JSON.parse(localStorage.getItem('users')) || {};
        let customDialects = JSON.parse(localStorage.getItem('customDialects')) || {};
        let headerVisible = false;
        
        // Initialisierung
        function init() {
            checkLoginStatus();
            loadSavedSettings();
            loadCustomDialects();
            updateClock();
            setInterval(updateClock, 50); // Aktualisiere alle 50ms für flüssigen Sekundenzeiger
            
            // Gradient-Previews Event-Listener
            document.querySelectorAll('.gradient-preview').forEach(preview => {
                preview.addEventListener('click', function() {
                    document.querySelectorAll('.gradient-preview').forEach(p => p.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedGradient = this.dataset.gradient;
                });
            });
            
            // Header-Hover-Effekt für bessere UX
            let headerTimeout;
            document.addEventListener('mousemove', function(e) {
                if (e.clientY < 80) {
                    document.getElementById('header').classList.add('visible');
                    clearTimeout(headerTimeout);
                } else {
                    headerTimeout = setTimeout(() => {
                        document.getElementById('header').classList.remove('visible');
                    }, 2000);
                }
            });
        }
        
        // Uhr-Funktionen
        function updateClock() {
            const now = new Date();
            
            // Konvertiere in die ausgewählte Zeitzone
            const options = { timeZone: selectedTimezone, hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const timeStr = now.toLocaleTimeString('de-CH', options);
            
            const hours = parseInt(timeStr.split(':')[0]);
            const minutes = parseInt(timeStr.split(':')[1]);
            const seconds = parseFloat(timeStr.split(':')[2]) + (now.getMilliseconds() / 1000);
            
            // Flüssiger Sekundenzeiger
            const secondsAngle = seconds * 6; // 360 Grad / 60 Sekunden = 6 Grad pro Sekunde
            const radius = 220; // Radius des Kreises
            
            const x = radius * Math.sin(secondsAngle * Math.PI / 180);
            const y = -radius * Math.cos(secondsAngle * Math.PI / 180);
            
            document.getElementById('secondHand').style.transform = `translate(${x}px, ${y}px)`;
            
            // Text auf Schweizerdeutsch aktualisieren
            const swissGermanTime = convertToSwissGerman(hours, minutes, selectedDialect);
            document.getElementById('timeText').innerText = swissGermanTime;
        }
        
        // Schweizerdeutsche Zeit-Konvertierungen für verschiedene Dialekte
        function convertToSwissGerman(hours, minutes, dialect) {
            // Basis-Stunden und -Minuten auf Schweizerdeutsch
            const baseHourNames = {
                0: 'zwölfi', 1: 'eis', 2: 'zwei', 3: 'drü', 4: 'vieri', 
                5: 'föifi', 6: 'sächsi', 7: 'sibni', 8: 'achti', 
                9: 'nüni', 10: 'zähni', 11: 'elfi', 12: 'zwölfi'
            };
            
            const baseMinuteNames = {
                1: 'eis', 2: 'zwöi', 3: 'drü', 4: 'vier', 5: 'föif',
                6: 'sächs', 7: 'sibä', 8: 'acht', 9: 'nün', 10: 'zäh',
                11: 'elf', 12: 'zwölf', 13: 'drizäh', 14: 'vierzäh', 15: 'füfzäh',
                16: 'sächzäh', 17: 'sibzäh', 18: 'achtzäh', 19: 'nünzäh', 20: 'zwänzg',
                21: 'einäzwänzg', 22: 'zwöiäzwänzg', 23: 'drüäzwänzg', 24: 'vieräzwänzg', 25: 'föifäzwänzg',
                26: 'sächsäzwänzg', 27: 'sibäzwänzg', 28: 'achtäzwänzg', 29: 'nünäzwänzg', 30: 'drissig'
            };
            
            // Vordefinierte Dialekte
            const predefinedDialects = {
                zuerich: {
                    hourNames: {...baseHourNames},
                    minuteNames: {...baseMinuteNames},
                    prefix: 's isch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'gli ',
                    minuteWord: 'Minute'
                },
                bern: {
                    hourNames: {...baseHourNames, 1: 'eis', 3: 'drü'},
                    minuteNames: {...baseMinuteNames, 1: 'eis', 2: 'zwöi', 7: 'siebä'},
                    prefix: 's isch ',
                    half: 'haubi ',
                    quarter: 'viertu ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'gli ',
                    minuteWord: 'Minute'
                },
                basel: {
                    hourNames: {...baseHourNames, 1: 'ais', 9: 'nyni'},
                    minuteNames: {...baseMinuteNames, 1: 'ais', 9: 'nyn', 19: 'nynzäh', 29: 'nynäzwanzig'},
                    prefix: 's isch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'glai ',
                    minuteWord: 'Minuttä'
                },
                luzern: {
                    hourNames: {...baseHourNames},
                    minuteNames: {...baseMinuteNames},
                    prefix: 's esch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'glei ',
                    minuteWord: 'Minute'
                },
                stgallen: {
                    hourNames: {...baseHourNames},
                    minuteNames: {...baseMinuteNames},
                    prefix: 's isch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'fast ',
                    minuteWord: 'Minute'
                },
                wallis: {
                    hourNames: {...baseHourNames, 1: 'eis', 3: 'dri'},
                    minuteNames: {...baseMinuteNames, 3: 'dri'},
                    prefix: 's ischt ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'gli ',
                    minuteWord: 'Minüta'
                },
                aargau: {
                    hourNames: {...baseHourNames},
                    minuteNames: {...baseMinuteNames},
                    prefix: 's esch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'ab ',
                    almost: 'glei ',
                    minuteWord: 'Minute'
                },
                thurgau: {
                    hourNames: {...baseHourNames},
                    minuteNames: {...baseMinuteNames},
                    prefix: 's isch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'naach ',
                    almost: 'glii ',
                    minuteWord: 'Minuute'
                },
                graubuenden: {
                    hourNames: {...baseHourNames, 1: 'eis', 3: 'drii'},
                    minuteNames: {...baseMinuteNames, 1: 'eis', 3: 'drii'},
                    prefix: 's isch ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'nach ',
                    almost: 'glich ',
                    minuteWord: 'Minuta'
                },
                appenzell: {
                    hourNames: {...baseHourNames},
                    minuteNames: {...baseMinuteNames},
                    prefix: 's ischt ',
                    half: 'halbi ',
                    quarter: 'viertel ',
                    to: 'vor ',
                    past: 'noch ',
                    almost: 'glii ',
                    minuteWord: 'Minuute'
                }
            };
            
            // Prüfe ob es ein benutzerdefinierter Dialekt ist
            let dialectSettings;
            if (customDialects[dialect]) {
                dialectSettings = customDialects[dialect];
            } else {
                dialectSettings = predefinedDialects[dialect] || predefinedDialects.zuerich;
            }
            
            // Stunden anpassen (für 12-Stunden-Format)
            let h = hours % 12;
            if (h === 0) h = 12;
            
            // Nächste Stunde für "vor" Formulierungen
            let nextHour = (h % 12) + 1;
            
            // Spezielle Zeiten
            if (minutes === 0) {
                return `${dialectSettings.prefix}${dialectSettings.hourNames[h]} Uhr`;
            } else if (minutes === 30) {
                return `${dialectSettings.prefix}${dialectSettings.half}${dialectSettings.hourNames[nextHour]}`;
            } else if (minutes === 15) {
                return `${dialectSettings.prefix}${dialectSettings.quarter}${dialectSettings.past}${dialectSettings.hourNames[h]}`;
            } else if (minutes === 45) {
                return `${dialectSettings.prefix}${dialectSettings.quarter}${dialectSettings.to}${dialectSettings.hourNames[nextHour]}`;
            }
            
            // Minuten in Worten
            let minuteText = '';
            if (minutes <= 30) {
                minuteText = dialectSettings.minuteNames[minutes] || minutes.toString();
                return `${dialectSettings.prefix}${minuteText} ${dialectSettings.minuteWord} ${dialectSettings.past}${dialectSettings.hourNames[h]}`;
            } else {
                const minutesToNext = 60 - minutes;
                minuteText = dialectSettings.minuteNames[minutesToNext] || minutesToNext.toString();
                return `${dialectSettings.prefix}${minuteText} ${dialectSettings.minuteWord} ${dialectSettings.to}${dialectSettings.hourNames[nextHour]}`;
            }
        }
        
        // Custom Dialekte Management
        function loadCustomDialects() {
            const dialectSelect = document.getElementById('dialect');
            const customDialectsList = document.getElementById('customDialectsList');
            
            // Entferne alte Custom-Optionen
            Array.from(dialectSelect.options).forEach(option => {
                if (option.dataset.custom === 'true') {
                    option.remove();
                }
            });
            
            // Füge Custom-Dialekte hinzu
            Object.keys(customDialects).forEach(dialectKey => {
                const option = document.createElement('option');
                option.value = dialectKey;
                option.textContent = customDialects[dialectKey].name;
                option.dataset.custom = 'true';
                dialectSelect.appendChild(option);
            });
            
            // Lade Custom-Dialekte-Liste
            customDialectsList.innerHTML = '';
            Object.keys(customDialects).forEach(dialectKey => {
                const dialectItem = createDialectItem(dialectKey, customDialects[dialectKey]);
                customDialectsList.appendChild(dialectItem);
            });
        }
        
        function createDialectItem(dialectKey, dialectData) {
            const item = document.createElement('div');
            item.className = 'custom-dialect-item';
            
            item.innerHTML = `
                <div class="custom-dialect-header">
                    <h4>${dialectData.name}</h4>
                    <button class="delete-dialect-btn" onclick="deleteCustomDialect('${dialectKey}')">Löschen</button>
                </div>
                <button onclick="editCustomDialect('${dialectKey}')">Bearbeiten</button>
            `;
            
            return item;
        }
        
        function createNewDialect() {
            const name = prompt('Name für den neuen Dialekt:');
            if (!name) return;
            
            const dialectKey = 'custom_' + Date.now();
            
            // Basis-Einstellungen vom Zürcher Dialekt übernehmen
            customDialects[dialectKey] = {
                name: name,
                hourNames: {
                    0: 'zwölfi', 1: 'eis', 2: 'zwei', 3: 'drü', 4: 'vieri', 
                    5: 'föifi', 6: 'sächsi', 7: 'sibni', 8: 'achti', 
                    9: 'nüni', 10: 'zähni', 11: 'elfi', 12: 'zwölfi'
                },
                minuteNames: {
                    1: 'eis', 2: 'zwöi', 3: 'drü', 4: 'vier', 5: 'föif',
                    6: 'sächs', 7: 'sibä', 8: 'acht', 9: 'nün', 10: 'zäh',
                    11: 'elf', 12: 'zwölf', 13: 'drizäh', 14: 'vierzäh',